<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Admin Panel - Velvet Vista Hotel</title>
	<link rel="stylesheet" href="/css/admin-home.css">
	<link rel="icon" th:href="@{/images/logo.png}">
</head>

<body>

	<div class="admin-container">
		<!-- Sidebar -->
		<aside class="sidebar">
			<h2>Welcome <br> <span th:text="${session.adminName}"></span> </h2>
			<nav>
				<div class="menu">
					<h3>Employees</h3>
					<button onclick="showSection('showEmployees')">Show All Employee</button>
					<button onclick="showSection('addEmployee')">Add Employee</button>
				</div>

				<div class="menu">
					<h3>Rooms</h3>
					<button onclick="showSection('showRooms')">Show All Room</button>
					<button onclick="showSection('addRoom')">Add Room</button>
				</div>

				<div class="menu">
					<h3>Booking Details</h3>
					<button onclick="showSection('showBookingDetails')">Show All Booking Details</button>
				</div>

				<div class="menu">
					<h3>Admin</h3>
					<button onclick="showSection('showAdmins')">Show All Admin</button>
				</div>

				<button class="logout-btn">Logout</button>
			</nav>
		</aside>
		<!-- Main Content -->
		<main class="content">
			<h3 th:if="${msg != null}">
				Message : <span style="color: red;" th:text="${msg}"></span>
			</h3>

			<section id="showEmployees" class="panel active">
				<h2>All Employees</h2>
				<table id="table-box">
					<thead>
						<tr>
							<th>Id</th>
							<th>Name</th>
							<th>Email</th>
							<th>Adhar</th>
							<th>Mobile</th>
							<th>Job-Role</th>
							<th>Gender</th>
							<th>Salary</th>
							<th>Password</th>
							<th>Update</th>
							<th>Remove</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="employee: ${employees}">
							<td th:text="${employee.getEmployee_Id()}"></td>
							<td th:text="${employee.getName()}"></td>
							<td th:text="${employee.getEmail()}"></td>
							<td th:text="${employee.getAdhar()}"></td>
							<td th:text="${employee.getPhone()}"></td>
							<td th:text="${employee.getJobRole()}"></td>
							<td th:text="${employee.getGender()}"></td>
							<td th:text="${employee.getSalary()}">$</td>
							<td th:text="${employee.getPassword()}"></td>
							<td>
								<!-- Update button (redirects to update form) -->
								<form th:action="@{/admin/employee-update-page/{id}(id=${employee.getEmployee_Id})}"
									method="post">
									<button class="btn btn-warning btn-sm">Update</button>
								</form>
							</td>
							<td>
								<!-- Delete button (sends POST request) -->
								<form th:action="@{/admin/delete-employee/{id}(id=${employee.getEmployee_Id})}"
									method="post" style="display:inline;">
									<button type="submit" style="background-color: red;"
										class="btn btn-danger btn-sm remove-btn">REMOVE</button>
								</form>
							</td>
						</tr>
				</table>
			</section>

			<section id="addEmployee" class="panel">
				<h2>Add Employee</h2>
				<form th:action="@{/admin/Register-New-Employee}" method="post">
					<input type="text" name="name" placeholder="Name" required>
					<input type="email" name="email" placeholder="Email" required>
					<input type="number" name="adhar" placeholder="Adhar" required>
					<input type="number" name="phone" placeholder="Phone" required>
					<select name="gender" id="gender" required>
						<option value="Male">Male</option>
						<option value="Female">Female</option>
						<option value="Other">Other</option>
					</select>
					<input type="text" name="jobRole" placeholder="Job-Role" required>
					<input type="number" name="salary" placeholder="Salary" required>
					<input type="password" name="password" placeholder="Password" required>
					<button type="submit">Add Employee</button>
				</form>
			</section>

			<section id="showRooms" class="panel">
				<h2>All Rooms</h2>
				<table id="table-box">
					<thead>
						<tr>
							<th>Room Number</th>
							<th>Price</th>
							<th>Room Type</th>
							<th>Availability</th>
							<th>Update</th>
							<th>Remove</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="room: ${rooms}">
							<td th:text="${room.getRoom_Id()}"></td>
							<td th:text="${room.getPrice()}"></td>
							<td th:text="${room.getBedSize()}"></td>
							<td th:text="${room.getAvailability()}"></td>
							<td>
								<!-- Update button (redirects to update form) -->
								<form th:action="@{/admin/room-update-page/{id}(id=${room.getRoom_Id})}" method="post">
									<button class="btn btn-warning btn-sm">Update</button>
								</form>
							</td>
							<td>
								<!-- Delete button (sends POST request) -->
								<form th:action="@{/admin/delete-room/{id}(id=${room.getRoom_Id})}" method="post"
									style="display:inline;">
									<button type="submit" style="background-color: red;"
										class="btn btn-danger btn-sm remove-btn">REMOVE</button>
								</form>
							</td>
						</tr>
				</table>
			</section>

			<section id="addRoom" class="panel">
				<h2>Add Room</h2>
				<form th:action="@{/admin/Register-New-Room}" method="post">
					<input type="number" name="price" placeholder="Price" required>
					<select name="bedSize" id="bedSize" required>
						<option value="Suite">Suite</option>
						<option value="Deluxe">Deluxe</option>
						<option value="Penthouse">Penthouse</option>
					</select>
					<select name="availability" id="availability" required>
						<option value="Available">Available</option>
						<option value="Booked">Booked</option>
					</select>
					<button type="submit">Add Room</button>
				</form>
			</section>


			<section id="showBookingDetails" class="panel">
				<h2>All Booking Details</h2><button id="refresh" type="button">Refresh</button>
				<div>
					<form id="bookingSearchForm">
						<input type="text" id="bookingIdInput" placeholder="Enter Booking ID" />
						<button type="submit">Search</button>
					</form>
				</div>
				<table id="table-box">
					<thead>
						<tr>
							<th>Booking ID</th>
							<th>Room Number</th>
							<th>Customer ID</th>
							<th>Booking Mode</th>
							<th>Booking Date</th>
							<th>Check In Date</th>
							<th>Check Out Date</th>
							<th>Paid Amount</th>
							<th>Pending Amount</th>
							<th>Total Amount</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="bookingDetail: ${bookingDetails}">
							<td class="bookingId" th:text="${bookingDetail.getBooking_Id()}"></td>
							<td th:text="${bookingDetail.getRoom().getRoom_Id()}"></td>
							<td th:text="${bookingDetail.getCustomer().getCustomer_Id()}"></td>
							<td th:text="${bookingDetail.getBookingMode()}"></td>
							<td th:text="${bookingDetail.getBookingDate()}"></td>
							<td th:text="${bookingDetail.getCheckInDate()}"></td>
							<td th:text="${bookingDetail.getCheckOutDate()}"></td>
							<td th:text="${bookingDetail.getPaidAmount()}"></td>
							<td th:text="${bookingDetail.getPendingAmount()}"></td>
							<td th:text="${bookingDetail.getTotalAmount()}"></td>
						</tr>
				</table>
			</section>

			<section id="showAdmins" class="panel">
				<h2>All Admins</h2>
				<table id="table-box">
					<thead>
						<tr>
							<th>Id</th>
							<th>Name</th>
							<th>Email</th>
							<th>Phone</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td th:text="${session.adminId}"></td>
							<td th:text="${session.adminName}"></td>
							<td th:text="${session.adminEmail}"></td>
							<td th:text="${session.adminPhone}"></td>
						</tr>
				</table>
			</section>
		</main>
	</div>

	<script src="/javascript/admin-home.js"></script>
</body>
<script>
	let bookingIds = document.getElementsByClassName("bookingId");
	document.getElementById("bookingSearchForm").addEventListener('submit', function (e) {
		e.preventDefault(); // prevent form reload
		hideAllTableRow();
		let input = document.getElementById("bookingIdInput").value.trim();
		Array.from(bookingIds).forEach(function (bookingId) {
			if (bookingId.textContent === input) {
				bookingId.parentElement.style.display = "table-row";
			}

		});
	});
	function hideAllTableRow() {
		Array.from(bookingIds).forEach(function (bookingId) {
			bookingId.parentElement.style.display = "none";
		});
	}
	document.getElementById("refresh").addEventListener("click", function () {
		Array.from(bookingIds).forEach(function (bookingId) {
			bookingId.parentElement.style.display = "table-row";
		});
	})
</script>

</html>